stages:
  - trigger

# Shared secrets (secured in GitLab Variables)
variables:
  DOCKERHUB_USER: $DOCKERHUB_USER
  DOCKERHUB_PASS: $DOCKERHUB_PASS

trigger_apiGateway:
  stage: trigger
  trigger:
    include: 'apiGateway/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "apiGateway/**/*"


trigger_chat:
  stage: trigger
  trigger:
    include: 'chatHandler/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "chatHandler/**/*"


trigger_token:
  stage: trigger
  trigger:
    include: 'generateToken/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "generateToken/**/*"


trigger_frontend:
  stage: trigger
  trigger:
    include: 'frontend/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "frontend/**/*"


trigger_getuser:
  stage: trigger
  trigger:
    include: 'getUser/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "getUser/**/*"


trigger_keyhandler:
  stage: trigger
  trigger:
    include: 'keyHandler/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "keyHandler/**/*"


trigger_logout:
  stage: trigger
  trigger:
    include: 'logout/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "logout/**/*"


trigger_updateaccount:
  stage: trigger
  trigger:
    include: 'updateAccount/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "updateAccount/**/*"


trigger_oauth:
  stage: trigger
  trigger:
    include: 'oAuth/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "oAuth/**/*"


trigger_login:
  stage: trigger
  trigger:
    include: 'login/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "login/**/*"


trigger_register:
  stage: trigger
  trigger:
    include: 'register/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "register/**/*"


trigger_mail:
  stage: trigger
  trigger:
    include: 'mail/.gitlab-ci.yml'
    strategy: depend
  rules:
    - if: '$CI_COMMIT_TAG'
      when: never
    - changes:
        - "mail/**/*"
